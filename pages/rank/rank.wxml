<view class="container">
  <view class="rank-list">
    <view class="rank-item" wx:for="{{rankList}}" wx:key="vid" bindtap="onItemTap" data-vid="{{item.vid}}">
      <view class="rank-index {{index < 3 ? 'top-3' : ''}}">{{index + 1}}</view>
      
      <!-- è§†é¢‘å°é¢å®¹å™¨ -->
      <view class="video-cover">
        <image src="{{item.video.coverUrl}}" mode="aspectFill" lazy-load="true"></image>
        <view class="duration" wx:if="{{item.video.duration}}">{{tools.formatTime(item.video.duration)}}</view>
      </view>

      <view class="rank-info">
        <!-- æ ‡é¢˜ -->
        <view class="rank-title text-ellipsis-2">{{item.video.title}}</view>
        
        <!-- UPä¸»ä¿¡æ¯ -->
        <view class="up-info">
          <text class="up-name">{{item.user.nickname}}</text>
        </view>
        
        <!-- çƒ­åŠ›å€¼ -->
        <view class="rank-stats">
          <text class="stat-item">ç»¼åˆå¾—åˆ†: {{item.score}}</text>
        </view>
        
        <!-- æ•°æ®ç»Ÿè®¡ -->
        <view class="rank-details">
          <view class="detail-item"><text class="icon">â–¶</text>{{tools.formatCount(item.play)}}</view>
          <view class="detail-item"><text class="icon">ğŸ‘</text>{{tools.formatCount(item.love)}}</view>
        </view>
      </view>
    </view>
  </view>
  
  <view wx:if="{{rankList.length === 0 && !loading}}" class="empty-tip">
    æš‚æ— æ’è¡Œæ•°æ®
  </view>
</view>

<wxs module="tools">
  // æ ¼å¼åŒ–æ•°å­—
  var formatCount = function(count) {
    if (!count) return 0;
    if (count > 10000) {
      return (count / 10000).toFixed(1) + 'ä¸‡';
    }
    return count;
  }

  // æ ¼å¼åŒ–æ—¶é•¿
  var formatTime = function(seconds) {
    if (!seconds) return '';
    var m = Math.floor(seconds / 60);
    var s = Math.floor(seconds % 60);
    if (m < 10) m = '0' + m;
    if (s < 10) s = '0' + s;
    return m + ':' + s;
  }

  module.exports = {
    formatCount: formatCount,
    formatTime: formatTime
  }
</wxs>

